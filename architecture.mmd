graph TB
    %% Users and External Interfaces
    User[ğŸ‘¤ User] --> Streamlit[ğŸ¨ Streamlit UI<br/>Port 8501]
    User --> API[ğŸŒ FastAPI API<br/>Port 8000]

    %% Frontend Layer
    Streamlit --> API

    %% Backend Layer
    API --> Agent[ğŸ¤– Procurement Agent<br/>LangGraph + LangChain]
    API --> Health[ğŸ’š Health Check]

    %% Agent Workflow
    Agent --> Analyze[ğŸ” Analyze Question<br/>Generate MongoDB Query]
    Analyze --> Execute[âš¡ Execute Query<br/>MongoDB Aggregation]
    Execute --> Format[ğŸ“ Format Response<br/>Natural Language]

    %% Data Layer
    Execute --> MongoDB[(ğŸ“Š MongoDB<br/>Purchase Orders<br/>Collection)]

    %% Data Ingestion
    CSV[ğŸ“„ CSV Data<br/>PURCHASE ORDER DATA EXTRACT.csv] --> DataLoader[ğŸ”„ Data Loader<br/>Schema Normalization]
    DataLoader --> MongoDB

    %% Configuration
    Config[âš™ï¸ Configuration<br/>Environment Variables] --> Agent
    Config --> DataLoader
    Config --> API

    %% External Dependencies
    Agent --> OpenAI[ğŸ¤– OpenAI GPT-4<br/>Query Generation]

    %% Docker Services
    subgraph "Docker Compose Services"
        direction TB
        MongoSvc[MongoDB Service<br/>mongo:7.0]
        AppSvc[FastAPI App Service<br/>Python + FastAPI]
        StreamlitSvc[Streamlit UI Service<br/>Python + Streamlit]
    end

    %% Service Mapping
    MongoDB -.-> MongoSvc
    API -.-> AppSvc
    Streamlit -.-> StreamlitSvc

    %% Styling
    classDef frontend fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef backend fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef data fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef external fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef config fill:#fafafa,stroke:#424242,stroke-width:2px

    class Streamlit,API frontend
    class Agent,Analyze,Execute,Format,Health backend
    class MongoDB,DataLoader,CSV data
    class OpenAI external
    class Config config
